"use strict";
exports.__esModule = true;
exports.VulnerabilityService = void 0;
var VulnerabilityService = /** @class */ (function () {
    function VulnerabilityService(inputJson) {
        this.inputJson = undefined;
        this.vulnerabilities = [];
        this.inputJson = inputJson;
        this.vulnerabilities = Object.values(inputJson.vulnerabilities);
    }
    VulnerabilityService.prototype.getHighestVulnerabilities = function () {
        var _this = this;
        var severitiesInOrder = ['critical', 'high', 'moderate', 'low', 'info'];
        var highestSeverity = severitiesInOrder
            .find(function (severity) { return _this.inputJson.metadata.vulnerabilities[severity] > 0; });
        return this.vulnerabilities.filter(function (vulnerability) { return highestSeverity === vulnerability.severity; });
    };
    VulnerabilityService.prototype.getVulnerabilitiesWhereFixAvailableIsNotTrue = function () {
        return this.vulnerabilities
            .filter(function (vulnerability) { return !(vulnerability.fixAvailable && vulnerability.fixAvailable === true); });
    };
    VulnerabilityService.prototype.assembleOutputJsonString = function (vulnerabilities) {
        var pairs = {};
        var keys = vulnerabilities.map(function (item) { return item.name; });
        keys.forEach(function (key) { return pairs[key] = vulnerabilities[keys.indexOf(key)]; });
        return JSON.stringify({
            vulnerabilities: pairs,
            auditReportVersion: this.inputJson.auditReportVersion,
            metadata: this.inputJson.metadata
        });
    };
    return VulnerabilityService;
}());
exports.VulnerabilityService = VulnerabilityService;
